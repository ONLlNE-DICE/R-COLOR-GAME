<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Peryahan 3D Color Dice ðŸŽ²</title>
  <style>
    body {
      background: #f3f3f3;
      font-family: sans-serif;
      text-align: center;
      margin: 0;
    }

    h1 {
      color: #d80000;
      text-shadow: 2px 2px gold;
      margin: 20px;
    }

    .game-area {
      width: 320px;
      height: 300px;
      margin: auto;
      background: linear-gradient(to bottom, #ffe066, #ffb347);
      border: 10px solid #007acc;
      position: relative;
      perspective: 1000px;
      overflow: hidden;
    }

    .dice {
      width: 60px;
      height: 60px;
      position: absolute;
      top: 120px;
      left: 0;
      transform-style: preserve-3d;
      transform: rotateX(0) rotateY(0);
      transition: transform 1.5s ease-in-out;
    }

    .rolling {
      animation: spin 1s ease-in-out;
    }

    @keyframes spin {
      0%   { transform: rotateX(0deg) rotateY(0deg); }
      100% { transform: rotateX(720deg) rotateY(720deg); }
    }

    .face {
      position: absolute;
      width: 60px;
      height: 60px;
      opacity: 0.95;
      border: 1px solid #333;
    }

    .face.front  { background: red;    transform: rotateY(0deg) translateZ(30px); }
    .face.back   { background: violet; transform: rotateY(180deg) translateZ(30px); }
    .face.right  { background: blue;   transform: rotateY(90deg) translateZ(30px); }
    .face.left   { background: green;  transform: rotateY(-90deg) translateZ(30px); }
    .face.top    { background: white;  transform: rotateX(-90deg) translateZ(30px); }
    .face.bottom { background: yellow; transform: rotateX(90deg) translateZ(30px); }

    button {
      margin: 20px;
      font-size: 18px;
      padding: 10px 20px;
      background: #28a745;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }

    .result {
      font-weight: bold;
      font-size: 16px;
      margin-bottom: 10px;
    }
  </style>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-database-compat.js"></script>
</head>
<body>

<h1>PERYAHAN COLOR GAME ðŸŽ²</h1>

<div class="game-area" id="gameArea"></div>
<div class="result" id="resultText">Waiting for roll...</div>
<button onclick="rollDice()">ROLL DICE</button>

<script>
  const rotations = {
    Red:    "rotateX(0deg) rotateY(0deg)",       // front
    Violet: "rotateX(0deg) rotateY(180deg)",     // back
    Blue:   "rotateX(0deg) rotateY(-90deg)",     // right
    Green:  "rotateX(0deg) rotateY(90deg)",      // left
    White:  "rotateX(90deg) rotateY(0deg)",      // âœ… top
    Yellow: "rotateX(-90deg) rotateY(0deg)"      // âœ… bottom
  };

  const colors = ["Red", "Blue", "Green", "Yellow", "White", "Violet"];
  const gameArea = document.getElementById("gameArea");
  const resultText = document.getElementById("resultText");

  // Firebase config
  const firebaseConfig = {
    apiKey: "AIzaSyCX6bXyHJEdUFSZTq2tBqFYFYNv7FSxD8",
    authDomain: "color-game-135fb.firebaseapp.com",
    databaseURL: "https://color-game-135fb-default-rtdb.firebaseio.com",
    projectId: "color-game-135fb",
    storageBucket: "color-game-135fb.appspot.com",
    messagingSenderId: "362417900313",
    appId: "1:362417900313:web:765a79e4c95fa17936fa30"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();
  const presetRef = db.ref("presetDice");
  let rigged = null;

  presetRef.on("value", snap => {
    rigged = snap.val();
  });

  function rollDice() {
    gameArea.innerHTML = "";
    resultText.textContent = "Rolling...";

    const results = rigged || [
      colors[Math.floor(Math.random() * colors.length)],
      colors[Math.floor(Math.random() * colors.length)],
      colors[Math.floor(Math.random() * colors.length)]
    ];

    results.forEach((color, i) => {
      const dice = document.createElement("div");
      dice.className = "dice rolling";
      dice.style.left = `${60 + i * 70}px`;

      ["front", "back", "right", "left", "top", "bottom"].forEach(face => {
        const f = document.createElement("div");
        f.className = `face ${face}`;
        dice.appendChild(f);
      });

      gameArea.appendChild(dice);

      setTimeout(() => {
        dice.classList.remove("rolling");
        dice.style.transform = rotations[color];
      }, 800);
    });

    resultText.textContent = `ðŸŽ¯ Result: ${results.join(", ")}`;
    presetRef.set(null);
  }
</script>

</body>
</html>
