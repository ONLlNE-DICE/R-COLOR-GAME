<!DOCTYPE html>
<html>
<head>
  <title>Color Game Control</title>
  <style>
    body {
      background: #111;
      color: white;
      text-align: center;
      font-family: sans-serif;
    }

    h1 {
      margin-bottom: 20px;
    }

    .dice-controls {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-bottom: 20px;
    }

    .dice-box {
      background: #222;
      padding: 15px;
      border-radius: 10px;
      border: 2px solid #444;
      min-width: 120px;
    }

    .color-btn {
      display: block;
      margin: 6px auto;
      padding: 10px 15px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      color: #fff;
      font-weight: bold;
      width: 100px;
    }

    .color-btn.Red { background: red; }
    .color-btn.Blue { background: blue; }
    .color-btn.Green { background: green; }
    .color-btn.Yellow { background: gold; color: black; }
    .color-btn.White { background: white; color: black; }
    .color-btn.Violet { background: purple; }

    .color-btn.selected {
      outline: 3px solid white;
    }

    button {
      font-size: 18px;
      padding: 10px 20px;
      margin: 10px;
      background: #28a745;
      border: none;
      color: white;
      border-radius: 8px;
      cursor: pointer;
    }

    button.clear {
      background: #dc3545;
    }

    .status, .live-result {
      margin-top: 20px;
      font-size: 18px;
      color: #ccc;
    }

    .live-result {
      color: #ffc107;
      font-weight: bold;
    }
  </style>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-database-compat.js"></script>
</head>
<body>
  <h1>ðŸŽ® Color Game Control Panel</h1>

  <div class="dice-controls">
    <div class="dice-box">
      <div>ðŸŽ² Dice 1</div>
      <div id="dice1-buttons"></div>
    </div>
    <div class="dice-box">
      <div>ðŸŽ² Dice 2</div>
      <div id="dice2-buttons"></div>
    </div>
    <div class="dice-box">
      <div>ðŸŽ² Dice 3</div>
      <div id="dice3-buttons"></div>
    </div>
  </div>

  <button onclick="setRig()">ðŸŽ¯ Set Rig</button>
  <button class="clear" onclick="clearRig()">ðŸ§¹ Clear</button>

  <div class="status" id="currentRig">Loading current preset...</div>
  <div class="live-result" id="liveResult">ðŸŽ² Waiting for live result...</div>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyCX6bXyHJEdUFSZTq2tBqFYFYNv7FSxD8",
      authDomain: "color-game-135fb.firebaseapp.com",
      databaseURL: "https://color-game-135fb-default-rtdb.firebaseio.com",
      projectId: "color-game-135fb",
      storageBucket: "color-game-135fb.appspot.com",
      messagingSenderId: "362417900313",
      appId: "1:362417900313:web:765a79e4c95fa17936fa30"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    const presetRef = db.ref("presetDice");
    const resultRef = db.ref("lastResult");

    const colors = ["Red", "Blue", "Green", "Yellow", "White", "Violet"];
    const selectedColors = ["Red", "Red", "Red"];

    function renderColorButtons(diceIndex) {
      const container = document.getElementById(`dice${diceIndex + 1}-buttons`);
      container.innerHTML = "";

      colors.forEach(color => {
        const btn = document.createElement("button");
        btn.className = `color-btn ${color}`;
        btn.textContent = color;
        btn.onclick = () => {
          selectedColors[diceIndex] = color;
          highlightSelected(diceIndex);
        };
        container.appendChild(btn);
      });

      highlightSelected(diceIndex);
    }

    function highlightSelected(index) {
      const container = document.getElementById(`dice${index + 1}-buttons`);
      const buttons = container.querySelectorAll(".color-btn");
      buttons.forEach(btn => {
        if (btn.textContent === selectedColors[index]) {
          btn.classList.add("selected");
        } else {
          btn.classList.remove("selected");
        }
      });
    }

    function setRig() {
      presetRef.set(selectedColors);
      document.getElementById("currentRig").textContent = `âœ… Set to: ${selectedColors.join(", ")}`;
    }

    function clearRig() {
      presetRef.set(null);
      document.getElementById("currentRig").textContent = "ðŸ§¹ Cleared. Dice will roll random.";
    }

    presetRef.on("value", snapshot => {
      const data = snapshot.val();
      const status = document.getElementById("currentRig");
      if (data && Array.isArray(data)) {
        status.textContent = `ðŸŽ¯ Current preset: ${data.join(", ")}`;
      } else {
        status.textContent = "ðŸŽ² No rig active (random roll)";
      }
    });

    resultRef.on("value", snapshot => {
      const data = snapshot.val();
      const liveResult = document.getElementById("liveResult");
      if (data && Array.isArray(data)) {
        liveResult.textContent = `ðŸŽ² Last Roll: ${data.join(", ")}`;
      } else {
        liveResult.textContent = "ðŸŽ² Waiting for live result...";
      }
    });

    // Render buttons for all 3 dice
    for (let i = 0; i < 3; i++) {
      renderColorButtons(i);
    }
  </script>
</body>
</html>
